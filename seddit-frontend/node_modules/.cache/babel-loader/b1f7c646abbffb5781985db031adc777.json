{"ast":null,"code":"var _jsxFileName = \"/Users/aarongu/dev/social-media/seddit-frontend/src/Post.js\";\nimport React from 'react';\nimport { getRequest, postRequest } from './requests.js';\nimport { BarLoader } from 'react-spinners';\n\nclass Post extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.isToday = someDate => {\n      const today = new Date();\n      return someDate.getDate() === today.getDate() && someDate.getMonth() === today.getMonth() && someDate.getFullYear() === today.getFullYear();\n    };\n\n    this.state = {\n      commenting: false\n    };\n    this.toggleComment = this.toggleComment.bind(this);\n  }\n\n  formatDate(date) {\n    date = new Date(date);\n    date = new Date(date.getTime() - date.getTimezoneOffset() * 60000);\n\n    if (this.isToday(date)) {\n      return date.toLocaleTimeString('en-US', {\n        hour12: true,\n        hour: \"numeric\",\n        minute: \"numeric\"\n      });\n    }\n\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  }\n\n  toggleComment() {\n    this.setState({\n      commenting: !this.state.commenting\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"card my-4 mx-md-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"card-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37\n      },\n      __self: this\n    }, this.props.author, \" \", React.createElement(\"span\", {\n      className: \"text-muted ml-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37\n      },\n      __self: this\n    }, this.formatDate(this.props.created))), React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"card-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39\n      },\n      __self: this\n    }, this.props.title), React.createElement(\"p\", {\n      className: \"card-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, this.props.body), React.createElement(Like, {\n      post_id: this.props.id,\n      user: this.props.user,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41\n      },\n      __self: this\n    }), React.createElement(\"a\", {\n      role: \"button\",\n      className: \"btn btn-light card-link\",\n      onClick: this.toggleComment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42\n      },\n      __self: this\n    }, \"Comment\")), React.createElement(\"div\", {\n      className: \"card-footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, React.createElement(Comment, {\n      post_id: this.props.id,\n      user: this.props.user,\n      sendComment: this.state.commenting,\n      toggleView: this.toggleComment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    })));\n  }\n\n}\n\nclass Like extends React.Component {\n  constructor(props) {\n    super(props); // props should be the post id, and make a separate request for the number of likes on the post so it can update state\n\n    this.componentDidMount = () => {\n      this.getLikes();\n      this.isLiked();\n    };\n\n    this.state = {\n      likes: null,\n      liked: null\n    };\n    this.getLikes = this.getLikes.bind(this);\n    this.isLiked = this.isLiked.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  getLikes() {\n    getRequest(\"like/\" + this.props.post_id + '/').then(response => {\n      this.setState({\n        likes: response['likes']\n      });\n    });\n  }\n\n  isLiked() {\n    if (this.props.user) {\n      postRequest('isliked/', {\n        \"user\": this.props.user,\n        \"post_id\": this.props.post_id\n      }).then(response => {\n        this.setState({\n          liked: response['liked']\n        });\n      });\n    } else {\n      this.setState({\n        liked: false\n      });\n    }\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n\n    if (!this.props.user) {\n      alert('Please login');\n      return;\n    }\n\n    if (this.state.liked) {\n      // send unlike\n      postRequest(\"unlike/\", {\n        \"user\": this.props.user,\n        \"post_id\": this.props.post_id\n      }).then(response => {\n        if (response['status'] === 'OK') {\n          this.setState({\n            likes: this.state.likes - 1,\n            liked: false\n          });\n        }\n      });\n    } else {\n      // send like\n      postRequest(\"like/\" + this.props.post_id + '/', {\n        \"user\": this.props.user,\n        \"post_id\": this.props.post_id\n      }).then(response => {\n        if (response['status'] === 'OK') this.setState({\n          likes: this.state.likes + 1,\n          liked: true\n        });\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"a\", {\n      role: \"button\",\n      className: \"btn btn-outline-light card-link\",\n      onClick: this.handleClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, this.state.liked ? React.createElement(\"img\", {\n      src: process.env.PUBLIC_URL + '/images/like-color.svg',\n      width: \"45\",\n      height: \"30\",\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }) : React.createElement(\"img\", {\n      src: process.env.PUBLIC_URL + '/images/like-gray.svg',\n      width: \"45\",\n      height: \"30\",\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      className: \"ml-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, this.state.likes));\n  }\n\n}\n\nclass Comment extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.isLoading = () => {\n      return this.state.posts == null;\n    };\n\n    this.state = {\n      rows: 1,\n      body: \"\",\n      comments: null\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  componentDidMount() {\n    getRequest('allcomments/' + this.props.post_id + '/').then(response => {\n      const commentsRes = response['comments'];\n      this.setState({\n        comments: commentsRes\n      });\n    });\n    this.interval = setInterval(() => {\n      getRequest('allcomments/' + this.props.post_id + '/').then(response => {\n        const commentsRes = response['comments'];\n        this.setState({\n          comments: commentsRes\n        });\n      });\n    }, 10000);\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n\n    if (!this.props.user) {\n      alert('Please login');\n      return;\n    }\n\n    postRequest('allcomments/' + this.props.post_id + '/', {\n      \"user\": this.props.user,\n      \"body\": this.state.body\n    }); // FIX THIS, IT NEEDS TO CONTAIN ALL OF THE REQUEST RESPONSE VARS\n\n    this.setState({\n      comments: this.state.comments.concat({\n        \"user\": this.props.user,\n        \"body\": this.state.body\n      })\n    });\n    this.props.toggleView();\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  render() {\n    if (this.props.sendComment) {\n      return React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"w-75 col-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"textarea\", {\n        className: \"form-control\",\n        name: \"body\",\n        rows: this.state.rows,\n        onChange: this.handleChange,\n        placeholder: \"Comment\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"w-25 col-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"btn btn-secondary\",\n        value: \"Send\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }))));\n    } else {\n      if (this.state.comments == null) {\n        return React.createElement(BarLoader, {\n          sizeUnit: \"px\",\n          size: 40,\n          loading: this.isLoading(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        });\n      }\n\n      var displayComments; // console.log(this.state.comments);\n\n      if (this.state.comments.length > 0) {\n        displayComments = this.state.comments.map((comment, idx) => React.createElement(\"div\", {\n          className: \"comment\",\n          key: idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        }, React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204\n          },\n          __self: this\n        }, comment['user'], \":\"), \" \", comment['body'])));\n      } else {\n        displayComments = React.createElement(\"p\", {\n          className: \"text-faded\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        }, \"No comments!\");\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, displayComments);\n    }\n  }\n\n}\n\nexport default Post;","map":{"version":3,"sources":["/Users/aarongu/dev/social-media/seddit-frontend/src/Post.js"],"names":["React","getRequest","postRequest","BarLoader","Post","Component","constructor","props","isToday","someDate","today","Date","getDate","getMonth","getFullYear","state","commenting","toggleComment","bind","formatDate","date","getTime","getTimezoneOffset","toLocaleTimeString","hour12","hour","minute","toLocaleDateString","year","month","day","setState","render","author","created","title","body","id","user","Like","componentDidMount","getLikes","isLiked","likes","liked","handleClick","post_id","then","response","e","preventDefault","alert","process","env","PUBLIC_URL","Comment","isLoading","posts","rows","comments","handleSubmit","handleChange","commentsRes","interval","setInterval","event","concat","toggleView","target","name","value","sendComment","displayComments","length","map","comment","idx"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { getRequest, postRequest } from './requests.js';\nimport {BarLoader} from 'react-spinners';\n\nclass Post extends React.Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            commenting: false\n        }\n        this.toggleComment = this.toggleComment.bind(this);\n    }\n\n    isToday = (someDate) => {\n        const today = new Date()\n        return someDate.getDate() === today.getDate() &&\n          someDate.getMonth() === today.getMonth() &&\n          someDate.getFullYear() === today.getFullYear()\n    }\n\n    formatDate(date){\n        date = new Date(date);\n        date = new Date(date.getTime() - date.getTimezoneOffset()*60000);\n        if(this.isToday(date)){\n            return date.toLocaleTimeString('en-US', {hour12: true, hour: \"numeric\", minute: \"numeric\"})\n        }\n        return date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });\n    }\n\n    toggleComment(){\n        this.setState({commenting: !this.state.commenting});\n    }\n\n    render(){\n        return (\n            <div className=\"card my-4 mx-md-3\">\n                <p className=\"card-header\">{this.props.author} <span className=\"text-muted ml-3\">{this.formatDate(this.props.created)}</span></p>\n                <div className=\"card-body\">\n                    <h1 className=\"card-title\">{this.props.title}</h1>\n                    <p className=\"card-text\">{this.props.body}</p>\n                    <Like post_id={this.props.id} user={this.props.user} />  \n                    <a role=\"button\" className=\"btn btn-light card-link\" onClick={this.toggleComment}>Comment</a>\n                </div>\n                <div className=\"card-footer\">\n                    <Comment post_id={this.props.id} user={this.props.user} sendComment={this.state.commenting} toggleView={this.toggleComment} />\n                </div>\n            </div>\n        );\n    }\n}\n\nclass Like extends React.Component{\n    constructor(props){ \n        super(props);\n        // props should be the post id, and make a separate request for the number of likes on the post so it can update state\n        this.state = {\n            likes: null,\n            liked: null\n        };\n        this.getLikes = this.getLikes.bind(this);\n        this.isLiked = this.isLiked.bind(this);\n        this.handleClick = this.handleClick.bind(this);\n        \n    }\n    componentDidMount = () => {\n        this.getLikes();\n        this.isLiked();\n    }\n    getLikes(){\n        getRequest(\"like/\"+this.props.post_id+'/').then((response) => {\n            this.setState({likes: response['likes']})\n        });\n    }\n    isLiked(){\n        if(this.props.user){\n            postRequest('isliked/', {\"user\": this.props.user, \"post_id\": this.props.post_id}).then((response) => {\n                this.setState({liked: response['liked']});\n            });\n        } else{\n            this.setState({liked: false});\n        }\n    }\n    handleClick(e){\n        e.preventDefault();\n\n        if(!this.props.user){\n            alert('Please login');\n            return;\n        }\n\n        if(this.state.liked){ // send unlike\n            postRequest(\"unlike/\", {\"user\": this.props.user, \"post_id\": this.props.post_id}).then((response) => {\n                if(response['status'] === 'OK'){\n                    this.setState({\n                        likes: this.state.likes - 1,\n                        liked: false\n                    });\n                }\n                    \n            });\n            \n        } else{ // send like\n            postRequest(\"like/\" + this.props.post_id + '/', \n                {\"user\": this.props.user, \"post_id\": this.props.post_id}\n            ).then((response) => {\n                if(response['status'] === 'OK')\n                    this.setState({\n                        likes: this.state.likes + 1,\n                        liked: true\n                    });\n            });\n        }\n    }\n    render(){\n        return(\n            <a role=\"button\" className=\"btn btn-outline-light card-link\" onClick={this.handleClick}>\n                {this.state.liked ? \n                <img src={process.env.PUBLIC_URL + '/images/like-color.svg'} width=\"45\" height=\"30\" alt=\"\" /> :\n                <img src={process.env.PUBLIC_URL + '/images/like-gray.svg'} width=\"45\" height=\"30\" alt=\"\" /> }\n                <span className=\"ml-1\">{this.state.likes}</span>\n            </a>\n        );\n    }\n}\n\nclass Comment extends React.Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            rows: 1,\n            body: \"\",\n            comments: null\n        }\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n    }\n    componentDidMount(){\n        getRequest('allcomments/' + this.props.post_id + '/').then((response) => {\n            const commentsRes = response['comments'];\n            this.setState({comments: commentsRes})\n        });\n\n        this.interval = setInterval(() => {\n            getRequest('allcomments/' + this.props.post_id + '/').then((response) => {\n                const commentsRes = response['comments'];\n                this.setState({comments: commentsRes})\n            });\n        }, 10000);\n    }\n    handleSubmit(event){\n        event.preventDefault();\n\n        if(!this.props.user){\n            alert('Please login');\n            return;\n        }\n\n        postRequest('allcomments/' + this.props.post_id + '/', \n            {\"user\": this.props.user, \"body\": this.state.body}\n        );\n\n        // FIX THIS, IT NEEDS TO CONTAIN ALL OF THE REQUEST RESPONSE VARS\n        this.setState({comments: this.state.comments.concat({\"user\": this.props.user, \"body\": this.state.body})});\n\n        this.props.toggleView();\n    }\n    handleChange(event){\n        this.setState({\n            [event.target.name]: event.target.value\n        });\n    }\n    isLoading = () => {\n        return this.state.posts == null;\n    }\n\n    render(){\n        if(this.props.sendComment){\n            return(\n                <form onSubmit={this.handleSubmit}>\n                    <div className=\"form-row\">\n                        <div className=\"w-75 col-auto\">\n                        <textarea className=\"form-control\" name=\"body\" rows={this.state.rows} onChange={this.handleChange} placeholder=\"Comment\" required ></textarea>\n                        </div>\n                        <div className=\"w-25 col-auto\">\n                        <input type=\"submit\" className=\"btn btn-secondary\" value=\"Send\" />\n                        </div>\n                    </div>\n                </form>\n            );\n        } else{\n            if(this.state.comments == null){\n                return <BarLoader\n                    sizeUnit={\"px\"}\n                    size={40}\n                    loading={this.isLoading()}\n                />\n            }\n            var displayComments;\n            // console.log(this.state.comments);\n            if(this.state.comments.length > 0){\n                displayComments = this.state.comments.map((comment, idx) =>\n                    <div className=\"comment\" key={idx}>\n                        {/* {idx === 0 ? \"\" : <hr />} */}\n                        <p><b>{comment['user']}:</b> {comment['body']}</p>\n                    </div>\n                );\n            } else {\n                displayComments = (\n                    <p className=\"text-faded\">No comments!</p>\n                );\n            }\n            return(\n                <div>\n                    {displayComments}\n                </div>\n            );\n        }\n    }\n}\n\nexport default Post;"]},"metadata":{},"sourceType":"module"}